"use strict";function _classCallCheck(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(i,t){for(var e=0;e<t.length;e++){var s=t[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}function _createClass(i,t,e){return t&&_defineProperties(i.prototype,t),e&&_defineProperties(i,e),i}var SliderWithoutFight=function(){function SliderWithoutFight(i,t){var e=this;_classCallCheck(this,SliderWithoutFight),this.slider=i,this.options=t,this.sliderTrack=this.slider.querySelector(".slider-track"),this.sliderWidth=this.slider.offsetWidth,this.maximumSwipingAtSlider=0,this.positionFinal=0,this.singleSwipe=0,this.positionPressedX,this.positionPressedY,this.positionSliderTrack=0,this.positionFingerPressSliderX,this.positionFingerPressSliderY,this.positionX_FingetCurrentMoment_OnSlider=0,this.positionY_FingetCurrentMoment_OnSlider=0,this.allowSwipe=!0,this.isScrollingSlider=!1,this.measuresMaximumSwipeOfSlider(),this.addOptions(),this.swipeAction_=function(){e.swipeAction()},this.swipeEnd_=function(){e.swipeEnd()},this.goingOutBoundsSlider=function(){e.swipeEnd(),e.sliderTrack.removeEventListener("mouseout",e.goingOutBoundsSlider)}}return _createClass(SliderWithoutFight,[{key:"addOptions",value:function addOptions(){this.scrollAfterAbruptStop=!this.options||this.options.scrollAfterAbruptStop}},{key:"getEvent",value:function getEvent(){return-1!=event.type.search("touch")?event.touches[0]:event}},{key:"measuresMaximumSwipeOfSlider",value:function measuresMaximumSwipeOfSlider(){var t=this;this.sliderTrack.querySelectorAll(".slide").forEach(function(i){t.maximumSwipingAtSlider+=i.offsetWidth}),this.maximumSwipingAtSlider-=this.slider.querySelector(".slider-list").offsetWidth}},{key:"checksOutOfBounds",value:function checksOutOfBounds(){(this.positionX_FingetCurrentMoment_OnSlider>=this.positionFingerPressSliderX&&0<this.positionSliderTrack-this.positionFinal||this.positionX_FingetCurrentMoment_OnSlider>=this.sliderWidth-this.positionFingerPressSliderX&&this.positionSliderTrack-this.positionFinal<0)&&(this.sliderTrack.removeEventListener("touchmove",this.swipeAction),this.swipeEnd())}},{key:"checkSliderCanBeMoved",value:function checkSliderCanBeMoved(){this.getEvent().clientY}},{key:"measuresSpeedTrafficSliderTrack",value:function measuresSpeedTrafficSliderTrack(){var i=(this.singleSwipe/this.swipeSlider_Time).toFixed(2);this.autoPushingSlider(i)}},{key:"autoPushingSlider",value:function autoPushingSlider(i){if(!(i<=.6)){var t=i*this.positionSliderTrack;t<this.positionSliderTrack&&(t=this.positionSliderTrack),"right"===this.directionSliderTrack&&(t=Math.round(t-(t-this.positionSliderTrack/1.45))),t>this.maximumSwipingAtSlider?t=this.maximumSwipingAtSlider:t<0&&(t=0),this.setsStyle_For_autoPushingSlider(t)}}},{key:"setsStyle_For_autoPushingSlider",value:function setsStyle_For_autoPushingSlider(i){var t=this;this.sliderTrack.style.transform="translate3d(-".concat(this.positionSliderTrack,"px, 0px, 0px)"),setTimeout(function(){t.sliderTrack.style.transform="translate3d(-".concat(i,"px, 0px, 0px)"),t.sliderTrack.style.transition="transform 1s ease-out",t.sliderTrack.addEventListener("transitionend",function(){t.sliderTrack.style.transition="none",t.positionFinal=i})},0)}},{key:"stopsAutoScrolling",value:function stopsAutoScrolling(){this.sliderTrack.style.transition="none"}},{key:"pushingSlider",value:function pushingSlider(){this.singleSwipe=Math.abs(this.positionSliderTrack-this.positionFinal),5<=this.singleSwipe&&(this.isScrollingSlider=!0),this.positionSliderTrack<=this.maximumSwipingAtSlider&&this.allowSwipe&&0<this.positionSliderTrack&&this.allowSwipe&&(this.sliderTrack.style.transform="translate3d(-".concat(this.positionSliderTrack,"px, 0px, 0px)"))}},{key:"swipeStart",value:function swipeStart(){this.stopsAutoScrolling();var i=this.getEvent();this.time_1=performance.now(),this.sliderTrack.addEventListener("mousemove",this.swipeAction_),this.sliderTrack.addEventListener("touchmove",this.swipeAction_,{passive:!0}),this.positionPressedX=i.clientX,this.positionPressedY=i.clientY,this.positionFingerPressSliderX=i.clientX-this.slider.getBoundingClientRect().x,this.positionFingerPressSliderY=i.clientY-this.slider.getBoundingClientRect().y,this.sliderTrack.style.transform="translate3d(".concat(-this.positionFinal,"px, 0px, 0px)"),this.sliderTrack.addEventListener("mouseout",this.goingOutBoundsSlider),this.slider.classList.add("slider-active")}},{key:"swipeAction",value:function swipeAction(){var i=this.getEvent();this.directionSliderTrack=this.positionPressedX<i.clientX?"right":"left",5<=Math.abs(i.clientY-this.positionPressedY)&&"touchmove"===event.type&&(this.isScrolledPage=!0,this.isScrolledPage&&!this.isScrollingSlider?(this.allowSwipe=!1,this.removeEventsSliderTrack()):this.isScrolledPage&&this.isScrollingSlider&&(this.allowSwipe=!0)),this.allowSwipe&&("touchmove"===event.type&&(this.positionX_FingetCurrentMoment_OnSlider=Math.abs(this.positionPressedX-i.clientX),this.positionY_FingetCurrentMoment_OnSlider=Math.abs(this.positionPressedY-i.clientY),this.checksOutOfBounds()),this.allowSwipe&&(this.positionSliderTrack=this.positionPressedX-i.clientX+this.positionFinal,this.pushingSlider()))}},{key:"swipeEnd",value:function swipeEnd(){this.positionFinal;this.singleSwipe=Math.abs(this.positionSliderTrack-this.positionFinal),this.positionFinal=this.positionSliderTrack,this.positionFinal>this.maximumSwipingAtSlider?this.positionFinal=this.maximumSwipingAtSlider:this.positionFinal<0&&(this.positionFinal=0),this.allowSwipe=!0,this.isScrollingSlider=!1,this.scrollAfterAbruptStop&&(this.swipeSlider_Time=performance.now()-this.time_1,this.measuresSpeedTrafficSliderTrack()),this.removeEventsSliderTrack()}},{key:"removeEventsSliderTrack",value:function removeEventsSliderTrack(){this.sliderTrack.removeEventListener("mousemove",this.swipeAction_),this.sliderTrack.removeEventListener("touchmove",this.swipeAction_),this.sliderTrack.removeEventListener("mouseout",this.goingOutBoundsSlider),this.sliderTrack.removeEventListener("touchend",this.swipeEnd_),this.slider.classList.remove("slider-active")}},{key:"run",value:function run(){var i=this;this.sliderTrack.addEventListener("touchstart",function(){i.swipeStart()},{passive:!0}),this.sliderTrack.addEventListener("touchend",this.swipeEnd_,{passive:!0}),this.sliderTrack.addEventListener("mousedown",function(){i.swipeStart()}),this.sliderTrack.addEventListener("mouseup",this.swipeEnd_)}}]),SliderWithoutFight}();